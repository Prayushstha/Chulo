<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- style -->
    <link rel="stylesheet" href="assets/CSS/homepage.css" />
    <link rel="stylesheet" href="assets/CSS/responsive.css" />
    <link rel="stylesheet" href="assets/CSS/navbar.css" />
    <link rel="stylesheet" href="assets/CSS/cart.css" />
    <link rel="stylesheet" href="assets/CSS/theme.css" />
    <!-- slider -->
    <link rel="stylesheet" href="assets/CSS/slider.css" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/swiper@8/swiper-bundle.min.css"
    />
    <!-- descriptions -->
    <link rel="stylesheet" href="assets/CSS/food-description.css" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="icon" type="image/x-icon" href="assets/images/logo/logo.png" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <script
      src="https://kit.fontawesome.com/a076d05399.js"
      crossorigin="anonymous"
    ></script>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Supermercado+One&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Supermercado+One&display=swap"
      rel="stylesheet"
    />
    <title>Homepage</title>
    <script src="assets/Backend/ui-enhancer.js"></script>
    <script>
      // Smooth Scrolling JS
      console.log("Smooth scroll initializing...");
      function smoothScrollWithOffset(target) {
        const element = document.querySelector(target);
        if (!element) {
          console.log("Element not found:", target);
          return;
        }
        const navbar = document.querySelector(".navbar");
        const categoriesBar = document.querySelector(".name");
        const navbarHeight = navbar ? navbar.offsetHeight : 0;
        const categoriesHeight = categoriesBar ? categoriesBar.offsetHeight : 0;
        const totalOffset = navbarHeight + categoriesHeight + 30;
        const elementPosition =
          element.getBoundingClientRect().top + window.pageYOffset;
        const targetPosition = elementPosition - totalOffset;
        console.log("Scrolling to position:", targetPosition);
        window.scrollTo({
          top: targetPosition,
          behavior: "smooth",
        });
      }
      document.addEventListener("DOMContentLoaded", function () {
        const sidebarLinks = document.querySelectorAll(
          '.sidebar-list a[href^="#"]'
        );
        console.log("Found sidebar links:", sidebarLinks.length);
        sidebarLinks.forEach((link) => {
          link.addEventListener("click", function (e) {
            e.preventDefault();
            e.stopPropagation();
            const target = this.getAttribute("href");
            console.log("Clicked:", target);
            smoothScrollWithOffset(target);
          });
        });
      });

      // Search Bar Toggle JS
      function toggleSearchBar() {
        const container = document.getElementById("navSearchContainer");
        const input = document.getElementById("navSearchInput");

        container.classList.toggle("active");

        // Focus on input when opened
        if (container.classList.contains("active")) {
          setTimeout(() => input.focus(), 300);
        }
      }
    </script>
  </head>

  <body id="home-link">
    <!-- Navbar -->
    <div class="navbar" style="font-size: larger">
      <a href="index.html">
        <div class="logo-container">
          <img class="logo" src="assets/images/logo/logo.png" />
          <p class="logo-name">Chulo</p>
        </div>
      </a>
      <ul>
        <li class="navbar-list search-nav-item" id="search">
          <div class="search-container">
            <input
              type="text"
              name="text"
              class="input"
              id="navSearchInput"
              required=""
              placeholder="Type to search..."
            />
            <div class="icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="ionicon"
                viewBox="0 0 512 512"
              >
                <title>Search</title>
                <path
                  d="M221.09 64a157.09 157.09 0 10157.09 157.09A157.1 157.1 0 00221.09 64z"
                  fill="none"
                  stroke="currentColor"
                  stroke-miterlimit="10"
                  stroke-width="32"
                ></path>
                <path
                  fill="none"
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-miterlimit="10"
                  stroke-width="32"
                  d="M338.29 338.29L448 448"
                ></path>
              </svg>
            </div>
          </div>
        </li>
        <li class="navbar-list" id="navhome">
          <a href="#home-link" id="navhome">Home</a>
        </li>
        <li class="navbar-list" id="navtrending">
          <a href="#Trending">Trending</a>
        </li>
        <li class="navbar-list" id="navabout">
          <a href="AboutUS.html">About Us</a>
        </li>

        <li class="navbar-list" id="navcart">
          <a href="#" id="cart-toggle-btn">
            <i class="fas fa-shopping-cart"></i>
            <span id="cart-badge" style="display: none">0</span>
          </a>
        </li>
        <li class="navbar-list" id="navprofile">
          <a href="signup.html"
            ><i class="fas fa-user-alt" style="scale: 1.4"></i
          ></a>
        </li>
      </ul>
    </div>
    <!-- Image slider -->

    <div class="food-slider-wrapper">
      <section id="food-slider-section">
        <div class="food-slider-container">
          <div class="swiper food-slider-swiper">
            <div class="swiper-wrapper">
              <!-- Slide 1 -->
              <div class="swiper-slide food-slider-slide">
                <div class="food-slider-img">
                  <img
                    src="assets/images/food-pictures/cheesepizza.jpg"
                    alt="Cheese Pizza"
                  />
                </div>
                <div class="food-slider-content">
                  <h1 class="food-slider-price">$20</h1>
                  <div class="food-slider-bottom">
                    <h2 class="food-slider-name">Cheese Pizza</h2>
                    <h3 class="food-slider-rating">
                      <span>4.5</span>
                      <div class="food-slider-stars">
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                      </div>
                    </h3>
                  </div>
                </div>
              </div>

              <!-- Slide 2 -->
              <div class="swiper-slide food-slider-slide">
                <div class="food-slider-img">
                  <img
                    src="assets/images/food-pictures/buffMomo.webp"
                    alt="Buff Momo"
                  />
                </div>
                <div class="food-slider-content">
                  <h1 class="food-slider-price">$20</h1>
                  <div class="food-slider-bottom">
                    <h2 class="food-slider-name">Buff Momo</h2>
                    <h3 class="food-slider-rating">
                      <span>4.5</span>
                      <div class="food-slider-stars">
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                      </div>
                    </h3>
                  </div>
                </div>
              </div>

              <!-- Slide 3 -->
              <div class="swiper-slide food-slider-slide">
                <div class="food-slider-img">
                  <img
                    src="assets/images/food-pictures/chickenBurger.jpg"
                    alt="Chicken Burger"
                  />
                </div>
                <div class="food-slider-content">
                  <h1 class="food-slider-price">$40</h1>
                  <div class="food-slider-bottom">
                    <h2 class="food-slider-name">Chicken Burger</h2>
                    <h3 class="food-slider-rating">
                      <span>4.5</span>
                      <div class="food-slider-stars">
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                      </div>
                    </h3>
                  </div>
                </div>
              </div>

              <!-- Slide 4 -->
              <div class="swiper-slide food-slider-slide">
                <div class="food-slider-img">
                  <img
                    src="assets/images/food-pictures/friedChicken.webp"
                    alt="Fried Chicken"
                  />
                </div>
                <div class="food-slider-content">
                  <h1 class="food-slider-price">$15</h1>
                  <div class="food-slider-bottom">
                    <h2 class="food-slider-name">Fried Chicken</h2>
                    <h3 class="food-slider-rating">
                      <span>4.5</span>
                      <div class="food-slider-stars">
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                      </div>
                    </h3>
                  </div>
                </div>
              </div>

              <!-- Slide 5 -->
              <div class="swiper-slide food-slider-slide">
                <div class="food-slider-img">
                  <img
                    src="assets/images/food-pictures/chickenMomo.jpg"
                    alt="Chicken Momo"
                  />
                </div>
                <div class="food-slider-content">
                  <h1 class="food-slider-price">$15</h1>
                  <div class="food-slider-bottom">
                    <h2 class="food-slider-name">Chicken Momo</h2>
                    <h3 class="food-slider-rating">
                      <span>4.5</span>
                      <div class="food-slider-stars">
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                        <ion-icon name="star"></ion-icon>
                      </div>
                    </h3>
                  </div>
                </div>
              </div>
            </div>

            <div class="food-slider-controls">
              <div class="swiper-button-prev food-slider-arrow">
                <ion-icon name="arrow-back-outline"></ion-icon>
              </div>
              <div class="swiper-button-next food-slider-arrow">
                <ion-icon name="arrow-forward-outline"></ion-icon>
              </div>
              <div class="swiper-pagination"></div>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Main Content -->
    <div class="name">
      <p id="categories">CATEGORIES</p>
    </div>

    <div class="food-preview-container">
      <div class="sidebar">
        <ul>
          <li class="sidebar-list">
            <a href="#Around-The-Globe">Around The Globe</a>
          </li>
          <li class="sidebar-list"><a href="#Trending">Trending</a></li>
          <li class="sidebar-list"><a href="#Dessert">Dessert</a></li>
          <li class="sidebar-list"><a href="#Healthy">Healthy Option</a></li>
          <li class="sidebar-list"><a href="#Desi">Desi food</a></li>
        </ul>
      </div>

      <div class="main-content">
        <!-- Around The Globe -->
        <div class="food-item-list" id="Around-The-Globe">
          <br />
          <div class="food-type-name">AROUND THE GLOBE</div>
        </div>
        <div class="food-1-preview"></div>

        <!-- Trending -->
        <div class="food-type-name" id="Trending">Trending</div>
        <div class="food-1-preview"></div>

        <!-- Dessert -->
        <div class="food-type-name" id="Dessert">DESSERT</div>
        <div class="food-1-preview"></div>

        <!-- Healthy -->
        <div class="food-type-name" id="Healthy">Healthy Option</div>
        <div class="food-1-preview"></div>

        <!-- Desi -->
        <div class="food-type-name" id="Desi">Desi Foods</div>
        <div class="food-1-preview"></div>
      </div>
    </div>
    <!-- Dialog -->
    <dialog
      id="dialog"
      style="
        max-width: 140vh;
        min-height: 70vh;
        margin: auto;
        border-radius: 24px;
        border: none;
      "
    >
      <button class="dialog-close-btn" onclick="closeDialog()">Ã—</button>
      <div class="food-description-container" id="desc">
        <div class="food-picture-container" style="max-width: 600px">
          <img class="food-description-picture" src="" />
        </div>

        <div class="food-description" style="margin-left: 20px">
          <div class="food-name">Chicken Burger</div>

          <div class="food-price">
            <div class="original-price">&#x20B9; 190</div>
            <div class="discounted-price">&#x20B9; 140</div>
          </div>

          <button class="buy-button">Buy</button>

          <div class="description">
            <div class="description-heading">DETAILS ABOUT THIS MEAL</div>
            <div class="description-content"></div>

            <div class="veg-non-veg">
              <img
                class="food-sticker"
                src="assets/images/food-pictures/icn-non-veg.svg"
              />
              <div class="veg-non">Non-veg</div>
            </div>

            <div class="ingredients-heading">INGREDIENTS</div>
            <div class="ingredients-content"></div>
          </div>

          <div class="nutrients-heading">NUTRIENTS</div>
          <div class="nutrients-content">
            <div class="nutrients-value">
              <div class="nutrients-number">450</div>
              <div>Energy (kcl)</div>
            </div>
            <div class="nutrients-value">
              <div class="nutrients-number">20</div>
              <div>Fats (g)</div>
            </div>
            <div class="nutrients-value">
              <div class="nutrients-number">35</div>
              <div>Carbs (g)</div>
            </div>
            <div class="nutrients-value">
              <div class="nutrients-number">4</div>
              <div>Fiber (g)</div>
            </div>
            <div class="nutrients-value">
              <div class="nutrients-number">37</div>
              <div>Protein (g)</div>
            </div>
          </div>
        </div>
      </div>
    </dialog>
    <!-- Cart -->
    <aside class="cart-sidebar" id="cart-sidebar">
      <div class="cart-header">
        <h2><i class="fas fa-shopping-bag"></i> Your Cart</h2>
        <button class="clear-cart-btn" onclick="clearCart()">Clear</button>
        <button class="close-cart-btn" id="close-cart-btn">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="cart-items-container" id="cart-items-container">
        <!-- Cart Items will be injected here via JS -->
        <div class="empty-cart-message">
          <i class="fas fa-shopping-basket"></i>
          <p>Your cart is empty</p>
        </div>
      </div>

      <div class="cart-footer">
        <div class="billing-summary">
          <div class="billing-row">
            <span>Subtotal</span>
            <span id="cart-subtotal">Rs. 0</span>
          </div>
          <div class="billing-row">
            <span>VAT (13%)</span>
            <span id="cart-tax">Rs. 0</span>
          </div>
          <div class="billing-row total">
            <span>Total</span>
            <span id="cart-total">Rs. 0</span>
          </div>
        </div>
        <button class="checkout-btn" onclick="checkout()">
          Proceed to Checkout
        </button>
      </div>
    </aside>

    <!-- Scripts -->

    <script src="assets/Backend/ordering.js"></script>
    <script src="assets/Backend/cart.js"></script>
    <script src="assets/Backend/search.js"></script>
    <script src="assets/Backend/descriptions.js"></script>

    <script>
      // Food Categories Configuration
      const categories = {
        "Around-The-Globe": [1, 2, 3, 4, 5],
        Trending: [4, 2, 3, 1, 6],
        Dessert: [7, 8, 9, 10],
        Healthy: [11, 12, 13, 14, 15],
        Desi: [16, 17, 18],
      };

      // Create HTML for a single food item
      function createFoodItemHTML(item, showRank = false, rank = null) {
        const originalPriceDisplay = showRank
          ? `#${rank}`
          : `&#x20B9; ${item.originalPrice}`;

        return `
    <div class="food-preview" data-id="${item.id}">
      <a onclick="showDialog(${item.id})">
        <div>
          <img class="food-picture" src="assets/images/food-pictures/${item.image}" alt="${item.name}">
        </div>
        <div class="food-description">
          <p class="food-name">${item.name}</p>
          <div class="food-sub-description">
            <p class="food-price">&#x20B9; ${item.price}</p>
            <div class="food-stock">
              <button class="buy-button" onclick="event.stopPropagation(); addToCart(${item.id})" id="buy-button">Buy</button>
            </div>
          </div>
        </div>
      </a>
    </div>
  `;
      }

      // Render a specific category
      function renderCategory(categoryId, itemIds, showRanks = false) {
        const container = document.getElementById(categoryId);

        if (!container) {
          console.error(`Container with id "${categoryId}" not found`);
          return;
        }

        let previewContainer = container.nextElementSibling;

        while (
          previewContainer &&
          !previewContainer.classList.contains("food-1-preview")
        ) {
          previewContainer = previewContainer.nextElementSibling;
        }

        if (!previewContainer) {
          console.error(
            `Preview container not found for category "${categoryId}"`
          );
          return;
        }

        previewContainer.innerHTML = "";

        itemIds.forEach((itemId, index) => {
          const item = foodItems.find((food) => food.id === itemId);
          if (item) {
            const rank = showRanks ? index + 1 : null;
            previewContainer.innerHTML += createFoodItemHTML(
              item,
              showRanks,
              rank
            );
          }
        });
      }

      // Render all categories
      function renderAllCategories() {
        console.log("Rendering all categories...");

        renderCategory("Around-The-Globe", categories["Around-The-Globe"]);
        renderCategory("Trending", categories["Trending"], true);
        renderCategory("Dessert", categories["Dessert"]);
        renderCategory("Healthy", categories["Healthy"]);
        renderCategory("Desi", categories["Desi"]);

        console.log("All categories rendered");

        // IMPORTANT: Initialize search after cards are rendered
        if (typeof initializeSearchAfterRender === "function") {
          initializeSearchAfterRender();
        }
      }

      // Initialize everything when DOM is ready
      document.addEventListener("DOMContentLoaded", function () {
        console.log("DOM Content Loaded");
        renderAllCategories();
      });
    </script>
    <!-- sliders -->
    <script
      type="module"
      src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"
    ></script>
    <script src="https://unpkg.com/swiper@8/swiper-bundle.min.js"></script>
    <script src="assets/Backend/slider.js"></script>
  </body>
</html>
